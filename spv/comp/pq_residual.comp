#version 450
layout(local_size_x = 256) in;

layout(std430, set=0, binding=0) readonly buffer X  { float x[]; };
layout(std430, set=0, binding=1) readonly buffer XH { float x_hat[]; };
layout(std430, set=0, binding=2) writeonly buffer R  { float r[]; };

layout(push_constant) uniform PC { uint n; } pc;

void main() {
    uint i = gl_GlobalInvocationID.x;
    if (i >= pc.n) return;
    r[i] = x[i] - x_hat[i];
}
